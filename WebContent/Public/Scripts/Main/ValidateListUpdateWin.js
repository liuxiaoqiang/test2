Ext.ns("Ynzc");
Ext.ns("Ynzc.manage");
Ynzc.manage.ValidateListUpdateWin=Ext.extend(Ext.Window,{
	id:"validateListUpdateWin",
	initComponent:function(){
		Ext.apply(this,{
			id:"validateListWin",
			title:"添加验证目录",
			height:600,
			width:500,
			autoScroll:true,
			resizable:false,
			modal:true,
			items:[{
				layout:"column",
				frame:true,
				items:[{
					layout:"column",
					frame:true,
		 			items:[{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"dirNo",
							fieldLabel:"目录编号",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"registerDate",
							fieldLabel:"注册日期",
							xtype:"datefield",
							readOnly:true,
							format:"Y-m-d",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"machineType",
							fieldLabel:"厂牌型号",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"machineNo",
							fieldLabel:"厂牌识别号",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"productor",
							fieldLabel:"生产企业",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"carColor",
							fieldLabel:"车色",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"license",
							fieldLabel:"许可证号",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"productorAddress",
							fieldLabel:"企业地址",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"productorPost",
							fieldLabel:"企业邮编",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"productorSeller",
							fieldLabel:"销售商",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"productorTel",
							fieldLabel:"企业电话",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"sellerTelephone",
							fieldLabel:"销售商电话",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
                    	columnWidth:1,
                   		id: "photoDir",
                   		xtype: "picpanel",
                   		defaultPicUrl: "./Public/Images/sys/noupload.gif",
                   		actionUrl: "main/tractorInfo.html?action=uploadPic",
                   		uploadWinTitle: "上传拖拉机图片",
                   		height: 300,
                   		width: 370
                    },{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"setRow",
							fieldLabel:"排数",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"isAuto",
							fieldLabel:"装卸",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
                    		id:"shapeSize",
                    		fieldLabel:"外廓尺寸",
                    		xtype:"textfield",
                    		readOnly:true,
                    		listeners:{
                    			'focus':function(){
                    				new Ext.Window({
                    					id:"outwin",
                    					title:"外廓尺寸[单位：<font color=red>MM</font>]",
                    					height:160,
                    					modal:true,
                    					width:200,
                    					resizable:false,
                    					layout:"form",
                    					bodyStyle:"padding:5px 5px",
                    					labelWidth:20,
                    					items:[{
                    						id:"outLength",
                    						fieldLabel:"长",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					},{
                    						id:"outWidth",
                    						fieldLabel:"宽",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					},{
                    						id:"outHeight",
                    						fieldLabel:"高",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					}],
                    					buttons:[{
                    						text:"确定",
                    						handler:function(){
                    							if(Ext.getCmp("outLength").getValue()==""||Ext.getCmp("outWidth").getValue()==""||Ext.getCmp("outHeight").getValue()==""){
                    								Ext.ux.Toast.msg("提示","录入的数据不完整，请检查!");
                    								return;
                    							}else{
                    								var res=Ext.getCmp("outLength").getValue()+","+Ext.getCmp("outWidth").getValue()+","+Ext.getCmp("outHeight").getValue();
                    								Ext.getCmp("outsize").setValue(res);
                    								Ext.getCmp("outwin").close();
                    							}
                    						}
                    					}]
                    				}).show(Ext.getCmp("shapeSize").getEl());
                    				if(Ext.getCmp("shapeSize").getValue()!=""){
                    					var strArray=Ext.getCmp("shapeSize").getValue().split(",");
                    					Ext.getCmp("outLength").setValue(strArray[0]);
                    					Ext.getCmp("outWidth").setValue(strArray[1]);
                    					Ext.getCmp("outHeight").setValue(strArray[2]);
                    				}
                    			}
                    		},
                    		anchor:'98%'
                    	}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
                    		id:"containerSize",
                    		fieldLabel:"货箱内部尺寸",
                    		xtype:"textfield",
                    		readOnly:true,
                    		listeners:{
                    			"focus":function(){
                    				new Ext.Window({
                    					id:"containerwin",
                    					title:"货箱内部尺寸[单位：<font color=red>MM</font>]",
                    					height:160,
                    					modal:true,
                    					width:200,
                    					resizable:false,
                    					layout:"form",
                    					bodyStyle:"padding:5px 5px",
                    					labelWidth:20,
                    					items:[{
                    						id:"containerLength",
                    						fieldLabel:"长",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					},{
                    						id:"containerWidth",
                    						fieldLabel:"宽",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					},{
                    						id:"containerHeight",
                    						fieldLabel:"高",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					}],
                    					buttons:[{
                    						text:"确定",
                    						handler:function(){
                    							if(Ext.getCmp("containerLength").getValue()==""||Ext.getCmp("containerWidth").getValue()==""||Ext.getCmp("containerHeight").getValue()==""){
                    								Ext.ux.Toast.msg("提示","录入的数据不完整，请检查!");
                    								return;
                    							}else{
                    								var res=Ext.getCmp("containerLength").getValue()+","+Ext.getCmp("containerWidth").getValue()+","+Ext.getCmp("containerHeight").getValue();
                    								Ext.getCmp("containersize").setValue(res);
                    								Ext.getCmp("containerwin").close();
                    							}
                    						}
                    					}]
                    				}).show(Ext.getCmp("containerSize").getEl());
                    				if(Ext.getCmp("containerSize").getValue()!=""){
                    					var strArray=Ext.getCmp("containerSize").getValue().split(",");
                    					Ext.getCmp("containerLength").setValue(strArray[0]);
                    					Ext.getCmp("containerWidth").setValue(strArray[1]);
                    					Ext.getCmp("containerHeight").setValue(strArray[2]);
                    				}
                    			}
                    		},
                    		anchor:'100%'
                    	}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"axisSize",
							fieldLabel:"轴距",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
                    		id:"power",
                    		fieldLabel:"功率",
                    		xtype:"textfield",
                    		readOnly:true,
                    		listeners:{
                    			"focus":function(){
                    				new Ext.Window({
                    					id:"powerwin",
                    					title:"功率",
                    					height:115,
                    					modal:true,
                    					width:200,
                    					resizable:false,
                    					bodyStyle:"padding:5px 5px",
                    					labelWidth:20,
                    					layout:"fit",
                    					items:[{
                    						layout:"column",
                    						frame:true,
                    						border:false,
	                    					items:[{
	                    						columnWidth:.35,
	                    						items:[{
	                    							id:"v",
	                    							xtype:"textfield",
	                    							anchor:"98%"
	                    						}]
	                    					},{
	                    						columnWidth:.15,
	                    						items:[{
	                    							id:"Vunit",
	                    							xtype:"label",
	                    							html:"CM³"
	                    						}]
	                    					},{
		                    					columnWidth:.35,
	                    						items:[{
	                    							id:"k",
	                    							xtype:"textfield",
	                    							anchor:"98%"
	                    						}]
	                    					},{
	                    						columnWidth:.15,
	                    						items:[{
	                    							id:"KW",
	                    							xtype:"label",
	                    							html:"KW"
	                    						}]
	                    					}]
                    					}],
                    					buttons:[{
                    						text:"确定",
                    						handler:function(){
                    							if(Ext.getCmp("v").getValue()==""||Ext.getCmp("k").getValue()==""){
	                    							Ext.ux.Toast.msg("提示","录入的数据不完整，请检查!");
	                    							return;
                    							}else{
                    								var res=Ext.getCmp("v").getValue()+"CM³/"+Ext.getCmp("k").getValue()+"KW";
                    								Ext.getCmp("power").setValue(res);
                    								Ext.getCmp("powerwin").close();
                    							}
                    						}
                    					}]
                    				}).show(Ext.getCmp("power").getEl());
                    				if(Ext.getCmp("power").getValue()!=""){
           								var r1=Ext.getCmp("power").getValue().split("CM³/");
           								Ext.getCmp("v").setValue(r1[0]);
           								Ext.getCmp("k").setValue(r1[1].substring(0,r1[1].length-2));
                    				}
                    			}
                    		},
                    		anchor:'100%'
                    	}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
                    		id:"wheelSize",
                    		fieldLabel:"轮距",
                    		xtype:"textfield",
                    		readOnly:true,
                    		listeners:{
                    			"focus":function(){
                    				new Ext.Window({
                    					id:"wheelwin",
                    					title:"轮距[单位：<font color=red>MM</font>]",
                    					height:130,
                    					modal:true,
                    					width:200,
                    					resizable:false,
                    					layout:"form",
                    					bodyStyle:"padding:5px 5px",
                    					labelWidth:20,
                    					items:[{
                    						id:"wheelFront",
                    						fieldLabel:"前",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					},{
                    						id:"wheelBack",
                    						fieldLabel:"后",
                    						xtype:"textfield",
                    						anchor:'100%'
                    					}],
                    					buttons:[{
                    						text:"确定",
                    						handler:function(){
                    							if(Ext.getCmp("wheelFront").getValue()==""||Ext.getCmp("wheelBack").getValue()==""){
                    								Ext.ux.Toast.msg("提示","录入的数据不完整，请检查!");
                    								return;
                    							}else{
                    								var res=Ext.getCmp("wheelFront").getValue()+","+Ext.getCmp("wheelBack").getValue();
                    								Ext.getCmp("wheelSize").setValue(res);
                    								Ext.getCmp("wheelwin").close();
                    							}
                    						}
                    					}]
                    				}).show(Ext.getCmp("wheelSize").getEl());
                    				if(Ext.getCmp("wheelSize").getValue()!=""){
                    					var strArray=Ext.getCmp("wheelSize").getValue().split(",");
                    					Ext.getCmp("wheelFront").setValue(strArray[0]);
                    					Ext.getCmp("wheelBack").setValue(strArray[1]);
                    				}
                    			}
                    		},
                    		anchor:'98%'
                    	}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"drivers",
							fieldLabel:"驱动类型",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"directControl",
                    		fieldLabel:"转向形式",
                    		xtype:"combo",
                    		displayField : 'display',
			                valueField : 'value',
			                typeAhead : true,
			                mode : 'local',
			                editable:false,
			                selectOnFoucs : true,
			                triggerAction : 'all',
			                store:Ynzc.manage.DirectStore,
                    		anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"topSpeed",
							fieldLabel:"最高时速",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"fuelTypeId",
							fieldLabel:"燃油类型",
							xtype:'combo',
	                        displayField : 'fuelname',
			                valueField : 'id',
			                typeAhead : true,
			                mode : 'remote',
			                editable : false,
			                selectOnFoucs : true,
			                triggerAction : 'all',
			                store:Ynzc.manage.FuelType,
			                emptyText:"请选择燃油类型",
			                anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"fuelCost",
							fieldLabel:"燃油消耗",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"wheelNo",
							fieldLabel:"轮数",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"allQuality",
							fieldLabel:"整备质量",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"tiresSize",
							fieldLabel:"轮胎规格",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"totalQuality",
							fieldLabel:"总质量",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"loadQuality",
							fieldLabel:"载质量",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"driverInNo",
							fieldLabel:"驾驶室人数",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"tilt",
							fieldLabel:"倾斜角",
							xtype:"textfield",
							anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"engineBrandId",
							fieldLabel:"发动机品牌",
							xtype:'ebcombo',
			                anchor:'98%'
						}]
					},{
						columnWidth:1,
						layout:"form",
						labelWidth:60,
						items:[{
							id:"steelSpring",
							fieldLabel:"钢板弹簧片数",
							xtype:"textfield",
							anchor:'98%'
						}]
					}]
				}]
			}],
			buttons:[{
				id:"savaBtn",
				text:"保存",
				handler:function(){
				if(Ext.getCmp("dirNo").getValue()==""){Ext.ux.Toast.msg("提示","请填写目录编号!");return}
				if(Ext.getCmp("registerDate").getValue()==""){Ext.ux.Toast.msg("提示","请填写注册日期!");return}
				if(Ext.getCmp("machineType").getValue()==""){Ext.ux.Toast.msg("提示","请填写厂牌型号!");return}
				if(Ext.getCmp("machineNo").getValue()==""){Ext.ux.Toast.msg("提示","请填写厂牌识别号!");return}
				if(Ext.getCmp("productor").getValue()==""){Ext.ux.Toast.msg("提示","请填写生产企业!");return}
				if(Ext.getCmp("carColor").getValue()==""){Ext.ux.Toast.msg("提示","请填写车色!");return}
				if(Ext.getCmp("license").getValue()==""){Ext.ux.Toast.msg("提示","请填写许可证号!");return}
				if(Ext.getCmp("productorAddress").getValue()==""){Ext.ux.Toast.msg("提示","请填写企业地址!");return}
				if(Ext.getCmp("productorPost").getValue()==""){Ext.ux.Toast.msg("提示","请填写企业邮编!");return}
				if(Ext.getCmp("productorSeller").getValue()==""){Ext.ux.Toast.msg("提示","请填写销售商!");return}
				if(Ext.getCmp("productorTel").getValue()==""){Ext.ux.Toast.msg("提示","请填写企业电话!");return}
				if(Ext.getCmp("sellerTelephone").getValue()==""){Ext.ux.Toast.msg("提示","请填写销售商电话!");return}
				if(Ext.getCmp("photoDir").getValue()==""){Ext.ux.Toast.msg("提示","请填写图片路径!");return}
				if(Ext.getCmp("setRow").getValue()==""){Ext.ux.Toast.msg("提示","请填写排数!");return}
				if(Ext.getCmp("isAuto").getValue()==""){Ext.ux.Toast.msg("提示","请填写装卸!");return}
				if(Ext.getCmp("shapeSize").getValue()==""){Ext.ux.Toast.msg("提示","请填写外形尺寸!");return}
				if(Ext.getCmp("containerSize").getValue()==""){Ext.ux.Toast.msg("提示","请填写货箱尺寸!");return}
				if(Ext.getCmp("axisSize").getValue()==""){Ext.ux.Toast.msg("提示","请填写轴距!");return}
				if(Ext.getCmp("power").getValue()==""){Ext.ux.Toast.msg("提示","请填写功率!");return}
				if(Ext.getCmp("wheelSize").getValue()==""){Ext.ux.Toast.msg("提示","请填写轮距!");return}
				if(Ext.getCmp("drivers").getValue()==""){Ext.ux.Toast.msg("提示","请填写驱动类型!");return}
				if(Ext.getCmp("directControl").getValue()==""){Ext.ux.Toast.msg("提示","请填写转向类型!");return}
				if(Ext.getCmp("topSpeed").getValue()==""){Ext.ux.Toast.msg("提示","请填写最高时速!");return}
				if(Ext.getCmp("fuelTypeId").getValue()==""){Ext.ux.Toast.msg("提示","请填写燃油类型!");return}
				if(Ext.getCmp("fuelCost").getValue()==""){Ext.ux.Toast.msg("提示","请填写燃油消耗!");return}
				if(Ext.getCmp("wheelNo").getValue()==""){Ext.ux.Toast.msg("提示","请填写轮数!");return}
				if(Ext.getCmp("allQuality").getValue()==""){Ext.ux.Toast.msg("提示","请填写整备质量!");return}
				if(Ext.getCmp("tiresSize").getValue()==""){Ext.ux.Toast.msg("提示","请填写轮胎规格!");return}
				if(Ext.getCmp("totalQuality").getValue()==""){Ext.ux.Toast.msg("提示","请填写总质量!");return}
				if(Ext.getCmp("loadQuality").getValue()==""){Ext.ux.Toast.msg("提示","请填写载质量!");return}
				if(Ext.getCmp("driverInNo").getValue()==""){Ext.ux.Toast.msg("提示","请填写驾驶室人数!");return}
				if(Ext.getCmp("tilt").getValue()==""){Ext.ux.Toast.msg("提示","请填写倾斜角!");return}
				if(Ext.getCmp("engineBrandId").getValue()==""){Ext.ux.Toast.msg("提示","请填写发动机品牌!");return}
				if(Ext.getCmp("steelSpring").getValue()==""){Ext.ux.Toast.msg("提示","请填写钢板弹簧片数!");return}
					Ext.Ajax.request({
						url:"main/validateList.html?action=updateValidateList",
						success:function(resp){
							var result=Ext.util.JSON.decode(resp.responseText);
							if(result.success==true){
								Ext.ux.Toast.msg("提示","验证目录添加成功!");
								Ext.getCmp("validateListMgr").getStore().reload();
								Ext.getCmp("validateListUpdateWin").close();
							}else{
								Ext.Msg.alert("提示","填写的验证目录已存在!");
							}
						},
						failure:function(){
							Ext.Msg.alert("警告","<font color=red>与服务器通讯失败!</font>");
						},
						params:{
							id:Ynzc.manage.validateListId,
							dirNo:Ext.getCmp("dirNo").getValue(),
							registerDate:Ext.util.Format.date(Ext.getCmp("registerDate").getValue(),'Y-m-d'),
							machineTypeId:Ext.getCmp("machineType").getValue(),
							machineNo:Ext.getCmp("machineNo").getValue(),
							productor:Ext.getCmp("productor").getValue(),
							carColor:Ext.getCmp("carColor").getValue(),
							license:Ext.getCmp("license").getValue(),
							productorAddress:Ext.getCmp("productorAddress").getValue(),
							productorPost:Ext.getCmp("productorPost").getValue(),
							productorSeller:Ext.getCmp("productorSeller").getValue(),
							productorTel:Ext.getCmp("productorTel").getValue(),
							sellerTelephone:Ext.getCmp("sellerTelephone").getValue(),
							photoDir:Ext.getCmp("photoDir").getValue(),
							setRow:Ext.getCmp("setRow").getValue(),
							isAuto:Ext.getCmp("isAuto").getValue(),
							shapeSize:Ext.getCmp("shapeSize").getValue(),
							containerSize:Ext.getCmp("containerSize").getValue(),
							axisSize:Ext.getCmp("axisSize").getValue(),
							power:Ext.getCmp("power").getValue(),
							wheelSize:Ext.getCmp("wheelSize").getValue(),
							drivers:Ext.getCmp("drivers").getValue(),
							directControl:Ext.getCmp("directControl").getValue(),
							topSpeed:Ext.getCmp("topSpeed").getValue(),
							fuelTypeId:Ext.getCmp("fuelTypeId").getValue(),
							fuelCost:Ext.getCmp("fuelCost").getValue(),
							wheelNo:Ext.getCmp("wheelNo").getValue(),
							allQuality:Ext.getCmp("allQuality").getValue(),
							tiresSize:Ext.getCmp("tiresSize").getValue(),
							totalQuality:Ext.getCmp("totalQuality").getValue(),
							loadQuality:Ext.getCmp("loadQuality").getValue(),
							driverInNo:Ext.getCmp("driverInNo").getValue(),
							tilt:Ext.getCmp("tilt").getValue(),
							engineBrandId:Ext.getCmp("engineBrandId").getValue(),
							steelSpring:Ext.getCmp("steelSpring").getValue()
						}
					});
				}
			},{
				id:"cancelBtn",
				text:"取消",
				handler:function(){
					Ext.getCmp("validateListUpdateWin").close();
				}
			}]
		});
		Ynzc.manage.ValidateListUpdateWin.superclass.initComponent.apply(this,arguments);
	}
});