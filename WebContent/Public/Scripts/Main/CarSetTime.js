Ext.ns("Ynzc");
Ext.ns("Ynzc.manage"); 

Ynzc.manage.CarSetTime=Ext.extend(Ext.Panel,{
		id:"carsettime",
		initComponent:function(){
			Ext.apply(this,{
				id:"carsettime",
				layout:"fit",
				bodyStyle:"padding:5px 5px",
				items:[{
					xtype:'fieldset',
					title:"拖拉机审核时间设置",
					collapsible:true,
					autoHeight:true,
					width:500,
					layout:"column",
					items:[{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carRegisterTime",
								fieldLabel:"拖拉机注册登记",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carCheckTime",
								fieldLabel:"拖拉机年度检验",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carChangeTime",
								fieldLabel:"拖拉机变更登记",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carTransferTime",
								fieldLabel:"拖拉机转移登记",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carReplaceTime",
								fieldLabel:"拖拉机补领、补换牌证",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carModifyRecordTime",
								fieldLabel:"拖拉机变更备案登记",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carMortgageTime",
								fieldLabel:"拖拉机抵押登记",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"carLogoutTime",
								fieldLabel:"拖拉机注销登记",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					}]
				}],
				buttons:[{
					text:"保存设置",
					handler:function(){
						if(Ext.getCmp("carRegisterTime").getValue().length>11){Ext.ux.Toast.msg("提示","注册审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carCheckTime").getValue().length>11){Ext.ux.Toast.msg("提示","年检审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carChangeTime").getValue().length>11){Ext.ux.Toast.msg("提示","变更审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carTransferTime").getValue().length>11){Ext.ux.Toast.msg("提示","转移审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carReplaceTime").getValue().length>11){Ext.ux.Toast.msg("提示","补领、补换牌证审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carModifyRecordTime").getValue().length>11){Ext.ux.Toast.msg("提示","变更备案审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carMortgageTime").getValue().length>11){Ext.ux.Toast.msg("提示","抵押审核时间必须小于11位整数!");return}
						if(Ext.getCmp("carLogoutTime").getValue().length>11){Ext.ux.Toast.msg("提示","注销审核时间必须小于11位整数!");return}
						var type = 1;
						Ext.Ajax.request({
							url:"main/setTime.html?action=updateCarSetTime",
							success:function(){
								Ext.ux.Toast.msg("提示","审核时间设置成功!");
							},
							failure:function(){
								Ext.Msg.alert("警告","<font color=red>与服务器通讯失败!</font>");
							},
							params:{
								id:type,
								carRegisterTime:Ext.getCmp("carRegisterTime").getValue(),
								carCheckTime:Ext.getCmp("carCheckTime").getValue(),
								carChangeTime:Ext.getCmp("carChangeTime").getValue(),
								carTransferTime:Ext.getCmp("carTransferTime").getValue(),
								carReplaceTime:Ext.getCmp("carReplaceTime").getValue(),
								carModifyRecordTime:Ext.getCmp("carModifyRecordTime").getValue(),
								carMortgageTime:Ext.getCmp("carMortgageTime").getValue(),
								carLogoutTime:Ext.getCmp("carLogoutTime").getValue()
							}
						});
					}
				}]
			});	
			Ynzc.manage.CarSetTime.superclass.initComponent.apply(this,arguments);
			Ext.Ajax.request({
				url:"main/setTime.html?action=findSetTime",
				success:function(resp){
					var result=Ext.util.JSON.decode(resp.responseText);
					Ext.getCmp("carRegisterTime").setValue(result.data[0].carRegisterTime);
					Ext.getCmp("carCheckTime").setValue(result.data[0].carCheckTime);
					Ext.getCmp("carChangeTime").setValue(result.data[0].carChangeTime);
					Ext.getCmp("carTransferTime").setValue(result.data[0].carTransferTime);
					Ext.getCmp("carReplaceTime").setValue(result.data[0].carReplaceTime);
					Ext.getCmp("carModifyRecordTime").setValue(result.data[0].carModifyRecordTime);
					Ext.getCmp("carMortgageTime").setValue(result.data[0].carMortgageTime);
					Ext.getCmp("carLogoutTime").setValue(result.data[0].carLogoutTime);
				}
			});
		}
});
Ext.reg("carsettime",Ynzc.manage.CarSetTime);