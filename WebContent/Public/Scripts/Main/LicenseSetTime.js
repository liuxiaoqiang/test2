Ext.ns("Ynzc");
Ext.ns("Ynzc.manage");

Ynzc.manage.LicenseSetTime=Ext.extend(Ext.Panel,{
		id:"licensesettime",
		initComponent:function(){
			Ext.apply(this,{
				id:"licensesettime",
				layout:"fit",
				bodyStyle:"padding:5px 5px",
	 			items:[{
					xtype:'fieldset',
					title:"驾驶证审核时间设置",
					collapsible:true,
					autoHeight:true,
					width:500,
					layout:"column",
					items:[{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseChangeTime",
								fieldLabel:"驾照变更审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseEndTime",
								fieldLabel:"驾照期满审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseDefaceTime",
								fieldLabel:"驾照污损审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseReplaceTime",
								fieldLabel:"驾照补证审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseInTime",
								fieldLabel:"驾照转入审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseOutTime",
								fieldLabel:"驾照转出审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					},{
						columnWidth:.5,
						layout:"column",
						border:false,
						items:[{
							columnWidth:.7,
							border:false,
							layout:'form',
							labelWidth:140,
							items:[{
								id:"licenseLogoutTime",
								fieldLabel:"驾照注销审核",
								xtype:"textfield",
								style:"text-align:right",
								anchor:'100%'
							}]
						},{
							columnWidth:.3,
							border:false,
							layout:'form',
							items:[{
								xtype:'label',
								html:'<div style="padding-top:4px;font-size:12px">&nbsp;分钟</div>'
							}]
						}]
					}]
				}],
				buttons:[{
					text:"保存设置",
					handler:function(){
						if(Ext.getCmp("licenseChangeTime").getValue().length>11){Ext.ux.Toast.msg("提示","变更审核时间必须小于11位整数!");return}
						if(Ext.getCmp("licenseEndTime").getValue().length>11){Ext.ux.Toast.msg("提示","期满审核时间必须小于11位整数!");return}
						if(Ext.getCmp("licenseDefaceTime").getValue().length>11){Ext.ux.Toast.msg("提示","驾照污损审核时间必须小于11位整数!");return}
						if(Ext.getCmp("licenseReplaceTime").getValue().length>11){Ext.ux.Toast.msg("提示","补证审核时间必须小于11位整数!");return}
						if(Ext.getCmp("licenseInTime").getValue().length>11){Ext.ux.Toast.msg("提示","转入审核时间必须小于11位整数!");return}
						if(Ext.getCmp("licenseOutTime").getValue().length>11){Ext.ux.Toast.msg("提示","转出审核时间必须小于11位整数!");return}
						if(Ext.getCmp("licenseLogoutTime").getValue().length>11){Ext.ux.Toast.msg("提示","注销审核时间必须小于11位整数!");return}
						var type = 1;
						Ext.Ajax.request({
							url:"main/setTime.html?action=updateLincenseSetTime",
							success:function(){
								Ext.ux.Toast.msg("提示","审核时间设置成功!");
							},
							failure:function(){
								Ext.Msg.alert("警告","<font color=red>与服务器通讯失败!</font>");
							},
							params:{
								id:type,
								licenseChangeTime:Ext.getCmp("licenseChangeTime").getValue(),
								licenseEndTime:Ext.getCmp("licenseEndTime").getValue(),
								licenseDefaceTime:Ext.getCmp("licenseDefaceTime").getValue(),
								licenseReplaceTime:Ext.getCmp("licenseReplaceTime").getValue(),
								licenseInTime:Ext.getCmp("licenseInTime").getValue(),
								licenseOutTime:Ext.getCmp("licenseOutTime").getValue(),
								licenseLogoutTime:Ext.getCmp("licenseLogoutTime").getValue()
							}
						});
					}
				}]
			});
			Ynzc.manage.LicenseSetTime.superclass.initComponent.apply(this,arguments);
			Ext.Ajax.request({
				url:"main/setTime.html?action=findSetTime",
				success:function(resp){
					var result=Ext.util.JSON.decode(resp.responseText);
					Ext.getCmp("licenseChangeTime").setValue(result.data[0].licenseChangeTime);
					Ext.getCmp("licenseEndTime").setValue(result.data[0].licenseEndTime);
					Ext.getCmp("licenseDefaceTime").setValue(result.data[0].licenseDefaceTime);
					Ext.getCmp("licenseReplaceTime").setValue(result.data[0].licenseReplaceTime);
					Ext.getCmp("licenseInTime").setValue(result.data[0].licenseInTime);
					Ext.getCmp("licenseOutTime").setValue(result.data[0].licenseOutTime);
					Ext.getCmp("licenseLogoutTime").setValue(result.data[0].licenseLogoutTime);
				}
			});
		}
});
Ext.reg("licensesettime",Ynzc.manage.LicenseSetTime);